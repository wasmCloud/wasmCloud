# Changelog

All notable changes to this project will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## v0.5.0 (2024-11-08)

### Chore

 - <csr-id-a65fa0a21f00ae82c2aef7377946fa96904e5dfb/> update secrets-types and client to 0.2.0
 - <csr-id-8e7537e4f1d3621aa34663581f593dc232b61693/> add README
 - <csr-id-03ff4ff5bbee52ae409a89309abc3203dd5a07bd/> Add variant to represent error processing policy
 - <csr-id-da879d3e50d32fe1c09edcf2b58cb2db9c9e2661/> update secrets integration to use the update config structure
   Update the secrets integration in a wasmCloud host to include
   information about the policy that determines which backend to
   communicate with. This is a change that comes in from wadm where the
   policy block now contains the information about which backend to use.
   
   This also passes any propertes defined on the policy to the correct
   backend, which are stored as a versioned string-encoded JSON object.

### New Features

 - <csr-id-1870276d4e99987dd7ba6804c1df078fa44e289e/> support new secret reference structure
 - <csr-id-abd804417409bf79e41d4d310af1947efa31eca7/> add secrets subcommand for managing secrets references
   This adds a set of commands for manually managing secrets references in
   a wasmCloud deployment. It is effectively a wrapper around configuration
   that properly formats and writes the data type to the config bucket.
   
   It also attempts to prevent you from interacting with secrets with the
   config subcommands by checking the name of the configuration key and
   redirecting you to the correct subcommand.
 - <csr-id-8de8062a2d31eb89fda63e1464a5f1d4b40adc93/> add not-found error
 - <csr-id-7442ccbc9c29da3cffede6ea0809288bd69ac7e2/> add wasmcloud secrets crate and initial implementation of a NATS KV backend
   This adds an example implementation of a _secrets backend_ for
   wasmCloud, backed by NATS KV. The API is defined in #2190, but the idea
   is that we can have many secrets backends running in a wasmCloud
   cluster, each of which is listening on a specific prefix. Hosts will
   communicate with these backends to retrieve secrets on behalf of
   applications before they are instantiated for the first time, similar to
   what we do with config.
   
   Common types and errors are stored in a separate crate so that other
   Rust implementations can reference them. As a follow up we should add
   OpenAPI specifications for these types to make it easier to develop
   backends written in other languages.
   
   The NATS KV backend implements the secrets API in addition to several
   unique endpoints for managing secrets and mappings between
   components/providers and keys. These endpoints are _not_ expected to be
   duplicated in any other implementation, but are only available to define
   an interface for managing secrets in NATS KV. Other backends will likely
   have their own process for managing secrets out of band and only be
   concerned with retrieving them.
   
   Secret payloads are encrypted using a key provided by the host on each
   request and a dedicated encryption key generated by the backend. For
   more information on why there are two keys, [see this
   link](https://cr.yp.to/ecdh.html) that decribes how Curve25519 works.
   The host is expected to provide two forms of _context_: the _runtime_
   context, which is information about the host itself including its
   labels, and the _build_ context of the component or provider, which is
   the signed JWT that it was built with. For now, both are expected to be
   present so that a secrets backend can pass that information to upstream
   APIs in order to make a policy decision on whether or not the component
   or provider is allowed to access that secret. For now, the host JWT will
   need to be self signed. This will change in future releases of wasmCloud
   where we will have better ways of providing signing keys to new hosts.
   
   In this particular implementation, secrets are stored encrypted in the
   KV bucket with a xkey, similar to how other secrets managers store
   secrets at rest.

### Bug Fixes

 - <csr-id-0346adee762f519e6cf377b84b4fdf0dce83c12d/> correct secret reference format

### Other

 - <csr-id-8403350432a2387d4a2bce9c096f002005ba54be/> bump wasmcloud-core v0.9.0, wash-lib v0.24.0, wasmcloud-tracing v0.7.0, wasmcloud-provider-sdk v0.8.0, wasmcloud-secrets-types v0.4.0, wash-cli v0.31.0, safety bump 5 crates
   SAFETY BUMP: wash-lib v0.24.0, wasmcloud-tracing v0.7.0, wasmcloud-provider-sdk v0.8.0, wash-cli v0.31.0, wasmcloud-secrets-client v0.4.0
 - <csr-id-835b49613f7f0d6903ad53d78f49c17db1e3d90e/> release and update CHANGELOG
 - <csr-id-7cd2e71cb82c1e1b75d0c89bd5bda343016e75f4/> bump for test-util release
   Bump wasmcloud-core v0.8.0, opentelemetry-nats v0.1.1, provider-archive v0.12.0, wasmcloud-runtime v0.3.0, wasmcloud-secrets-types v0.3.0, wasmcloud-secrets-client v0.3.0, wasmcloud-tracing v0.6.0, wasmcloud-host v0.82.0, wasmcloud-test-util v0.12.0, safety bump 8 crates
   
   SAFETY BUMP: wasmcloud-runtime v0.3.0, wasmcloud-secrets-client v0.3.0, wasmcloud-tracing v0.6.0, wasmcloud-host v0.82.0, wasmcloud-test-util v0.12.0, wasmcloud-provider-sdk v0.7.0, wash-cli v0.30.0, wash-lib v0.23.0

### Refactor

 - <csr-id-c666ef50fecc1ee248bf78d486a915ee077e3b4a/> include name with secret config
 - <csr-id-2ea22a28ca9fd1838fc03451f33d75690fc28f2a/> move SecretConfig into crate
 - <csr-id-b56982f437209ecaff4fa6946f8fe4c3068a62cd/> address feedback, application name optional

### New Features (BREAKING)

 - <csr-id-61b7cf6cdc878d0904f0d07a920c0816d4e5b100/> add field to request and config

### Bug Fixes (BREAKING)

 - <csr-id-37601b495343768a430447a4358b235a60a4300b/> remove unneeded name field

### Commit Statistics

<csr-read-only-do-not-edit/>

 - 17 commits contributed to the release over the course of 144 calendar days.
 - 17 commits were understood as [conventional](https://www.conventionalcommits.org).
 - 0 issues like '(#ID)' were seen in commit messages

### Commit Details

<csr-read-only-do-not-edit/>

<details><summary>view details</summary>

 * **Uncategorized**
    - Bump wasmcloud-core v0.9.0, wash-lib v0.24.0, wasmcloud-tracing v0.7.0, wasmcloud-provider-sdk v0.8.0, wasmcloud-secrets-types v0.4.0, wash-cli v0.31.0, safety bump 5 crates ([`8403350`](https://github.com/wasmCloud/wasmCloud/commit/8403350432a2387d4a2bce9c096f002005ba54be))
    - Release and update CHANGELOG ([`835b496`](https://github.com/wasmCloud/wasmCloud/commit/835b49613f7f0d6903ad53d78f49c17db1e3d90e))
    - Bump for test-util release ([`7cd2e71`](https://github.com/wasmCloud/wasmCloud/commit/7cd2e71cb82c1e1b75d0c89bd5bda343016e75f4))
    - Remove unneeded name field ([`37601b4`](https://github.com/wasmCloud/wasmCloud/commit/37601b495343768a430447a4358b235a60a4300b))
    - Update secrets-types and client to 0.2.0 ([`a65fa0a`](https://github.com/wasmCloud/wasmCloud/commit/a65fa0a21f00ae82c2aef7377946fa96904e5dfb))
    - Add field to request and config ([`61b7cf6`](https://github.com/wasmCloud/wasmCloud/commit/61b7cf6cdc878d0904f0d07a920c0816d4e5b100))
    - Add README ([`8e7537e`](https://github.com/wasmCloud/wasmCloud/commit/8e7537e4f1d3621aa34663581f593dc232b61693))
    - Include name with secret config ([`c666ef5`](https://github.com/wasmCloud/wasmCloud/commit/c666ef50fecc1ee248bf78d486a915ee077e3b4a))
    - Move SecretConfig into crate ([`2ea22a2`](https://github.com/wasmCloud/wasmCloud/commit/2ea22a28ca9fd1838fc03451f33d75690fc28f2a))
    - Address feedback, application name optional ([`b56982f`](https://github.com/wasmCloud/wasmCloud/commit/b56982f437209ecaff4fa6946f8fe4c3068a62cd))
    - Correct secret reference format ([`0346ade`](https://github.com/wasmCloud/wasmCloud/commit/0346adee762f519e6cf377b84b4fdf0dce83c12d))
    - Add variant to represent error processing policy ([`03ff4ff`](https://github.com/wasmCloud/wasmCloud/commit/03ff4ff5bbee52ae409a89309abc3203dd5a07bd))
    - Update secrets integration to use the update config structure ([`da879d3`](https://github.com/wasmCloud/wasmCloud/commit/da879d3e50d32fe1c09edcf2b58cb2db9c9e2661))
    - Support new secret reference structure ([`1870276`](https://github.com/wasmCloud/wasmCloud/commit/1870276d4e99987dd7ba6804c1df078fa44e289e))
    - Add secrets subcommand for managing secrets references ([`abd8044`](https://github.com/wasmCloud/wasmCloud/commit/abd804417409bf79e41d4d310af1947efa31eca7))
    - Add not-found error ([`8de8062`](https://github.com/wasmCloud/wasmCloud/commit/8de8062a2d31eb89fda63e1464a5f1d4b40adc93))
    - Add wasmcloud secrets crate and initial implementation of a NATS KV backend ([`7442ccb`](https://github.com/wasmCloud/wasmCloud/commit/7442ccbc9c29da3cffede6ea0809288bd69ac7e2))
</details>

## v0.4.0 (2024-08-23)

<csr-id-a65fa0a21f00ae82c2aef7377946fa96904e5dfb/>
<csr-id-8e7537e4f1d3621aa34663581f593dc232b61693/>
<csr-id-03ff4ff5bbee52ae409a89309abc3203dd5a07bd/>
<csr-id-da879d3e50d32fe1c09edcf2b58cb2db9c9e2661/>
<csr-id-835b49613f7f0d6903ad53d78f49c17db1e3d90e/>
<csr-id-7cd2e71cb82c1e1b75d0c89bd5bda343016e75f4/>
<csr-id-c666ef50fecc1ee248bf78d486a915ee077e3b4a/>
<csr-id-2ea22a28ca9fd1838fc03451f33d75690fc28f2a/>
<csr-id-b56982f437209ecaff4fa6946f8fe4c3068a62cd/>

### Chore

 - <csr-id-a65fa0a21f00ae82c2aef7377946fa96904e5dfb/> update secrets-types and client to 0.2.0
 - <csr-id-8e7537e4f1d3621aa34663581f593dc232b61693/> add README
 - <csr-id-03ff4ff5bbee52ae409a89309abc3203dd5a07bd/> Add variant to represent error processing policy
 - <csr-id-da879d3e50d32fe1c09edcf2b58cb2db9c9e2661/> update secrets integration to use the update config structure
   Update the secrets integration in a wasmCloud host to include
   information about the policy that determines which backend to
   communicate with. This is a change that comes in from wadm where the
   policy block now contains the information about which backend to use.
   
   This also passes any propertes defined on the policy to the correct
   backend, which are stored as a versioned string-encoded JSON object.

### New Features

 - <csr-id-1870276d4e99987dd7ba6804c1df078fa44e289e/> support new secret reference structure
 - <csr-id-abd804417409bf79e41d4d310af1947efa31eca7/> add secrets subcommand for managing secrets references
   This adds a set of commands for manually managing secrets references in
   a wasmCloud deployment. It is effectively a wrapper around configuration
   that properly formats and writes the data type to the config bucket.
   
   It also attempts to prevent you from interacting with secrets with the
   config subcommands by checking the name of the configuration key and
   redirecting you to the correct subcommand.
 - <csr-id-8de8062a2d31eb89fda63e1464a5f1d4b40adc93/> add not-found error
 - <csr-id-7442ccbc9c29da3cffede6ea0809288bd69ac7e2/> add wasmcloud secrets crate and initial implementation of a NATS KV backend
   This adds an example implementation of a _secrets backend_ for
   wasmCloud, backed by NATS KV. The API is defined in #2190, but the idea
   is that we can have many secrets backends running in a wasmCloud
   cluster, each of which is listening on a specific prefix. Hosts will
   communicate with these backends to retrieve secrets on behalf of
   applications before they are instantiated for the first time, similar to
   what we do with config.
   
   Common types and errors are stored in a separate crate so that other
   Rust implementations can reference them. As a follow up we should add
   OpenAPI specifications for these types to make it easier to develop
   backends written in other languages.
   
   The NATS KV backend implements the secrets API in addition to several
   unique endpoints for managing secrets and mappings between
   components/providers and keys. These endpoints are _not_ expected to be
   duplicated in any other implementation, but are only available to define
   an interface for managing secrets in NATS KV. Other backends will likely
   have their own process for managing secrets out of band and only be
   concerned with retrieving them.
   
   Secret payloads are encrypted using a key provided by the host on each
   request and a dedicated encryption key generated by the backend. For
   more information on why there are two keys, [see this
   link](https://cr.yp.to/ecdh.html) that decribes how Curve25519 works.
   The host is expected to provide two forms of _context_: the _runtime_
   context, which is information about the host itself including its
   labels, and the _build_ context of the component or provider, which is
   the signed JWT that it was built with. For now, both are expected to be
   present so that a secrets backend can pass that information to upstream
   APIs in order to make a policy decision on whether or not the component
   or provider is allowed to access that secret. For now, the host JWT will
   need to be self signed. This will change in future releases of wasmCloud
   where we will have better ways of providing signing keys to new hosts.
   
   In this particular implementation, secrets are stored encrypted in the
   KV bucket with a xkey, similar to how other secrets managers store
   secrets at rest.

### Bug Fixes

 - <csr-id-0346adee762f519e6cf377b84b4fdf0dce83c12d/> correct secret reference format

### Other

 - <csr-id-835b49613f7f0d6903ad53d78f49c17db1e3d90e/> release and update CHANGELOG
 - <csr-id-7cd2e71cb82c1e1b75d0c89bd5bda343016e75f4/> bump for test-util release
   Bump wasmcloud-core v0.8.0, opentelemetry-nats v0.1.1, provider-archive v0.12.0, wasmcloud-runtime v0.3.0, wasmcloud-secrets-types v0.3.0, wasmcloud-secrets-client v0.3.0, wasmcloud-tracing v0.6.0, wasmcloud-host v0.82.0, wasmcloud-test-util v0.12.0, safety bump 8 crates
   
   SAFETY BUMP: wasmcloud-runtime v0.3.0, wasmcloud-secrets-client v0.3.0, wasmcloud-tracing v0.6.0, wasmcloud-host v0.82.0, wasmcloud-test-util v0.12.0, wasmcloud-provider-sdk v0.7.0, wash-cli v0.30.0, wash-lib v0.23.0

### Refactor

 - <csr-id-c666ef50fecc1ee248bf78d486a915ee077e3b4a/> include name with secret config
 - <csr-id-2ea22a28ca9fd1838fc03451f33d75690fc28f2a/> move SecretConfig into crate
 - <csr-id-b56982f437209ecaff4fa6946f8fe4c3068a62cd/> address feedback, application name optional

### New Features (BREAKING)

 - <csr-id-61b7cf6cdc878d0904f0d07a920c0816d4e5b100/> add field to request and config

### Bug Fixes (BREAKING)

 - <csr-id-37601b495343768a430447a4358b235a60a4300b/> remove unneeded name field

## v0.3.0 (2024-07-31)

<csr-id-a65fa0a21f00ae82c2aef7377946fa96904e5dfb/>
<csr-id-8e7537e4f1d3621aa34663581f593dc232b61693/>
<csr-id-03ff4ff5bbee52ae409a89309abc3203dd5a07bd/>
<csr-id-da879d3e50d32fe1c09edcf2b58cb2db9c9e2661/>
<csr-id-c666ef50fecc1ee248bf78d486a915ee077e3b4a/>
<csr-id-2ea22a28ca9fd1838fc03451f33d75690fc28f2a/>
<csr-id-b56982f437209ecaff4fa6946f8fe4c3068a62cd/>

### Chore

 - <csr-id-a65fa0a21f00ae82c2aef7377946fa96904e5dfb/> update secrets-types and client to 0.2.0
 - <csr-id-8e7537e4f1d3621aa34663581f593dc232b61693/> add README
 - <csr-id-03ff4ff5bbee52ae409a89309abc3203dd5a07bd/> Add variant to represent error processing policy
 - <csr-id-da879d3e50d32fe1c09edcf2b58cb2db9c9e2661/> update secrets integration to use the update config structure
   Update the secrets integration in a wasmCloud host to include
   information about the policy that determines which backend to
   communicate with. This is a change that comes in from wadm where the
   policy block now contains the information about which backend to use.
   
   This also passes any propertes defined on the policy to the correct
   backend, which are stored as a versioned string-encoded JSON object.

### New Features

 - <csr-id-1870276d4e99987dd7ba6804c1df078fa44e289e/> support new secret reference structure
 - <csr-id-abd804417409bf79e41d4d310af1947efa31eca7/> add secrets subcommand for managing secrets references
   This adds a set of commands for manually managing secrets references in
   a wasmCloud deployment. It is effectively a wrapper around configuration
   that properly formats and writes the data type to the config bucket.
   
   It also attempts to prevent you from interacting with secrets with the
   config subcommands by checking the name of the configuration key and
   redirecting you to the correct subcommand.
 - <csr-id-8de8062a2d31eb89fda63e1464a5f1d4b40adc93/> add not-found error
 - <csr-id-7442ccbc9c29da3cffede6ea0809288bd69ac7e2/> add wasmcloud secrets crate and initial implementation of a NATS KV backend
   This adds an example implementation of a _secrets backend_ for
   wasmCloud, backed by NATS KV. The API is defined in #2190, but the idea
   is that we can have many secrets backends running in a wasmCloud
   cluster, each of which is listening on a specific prefix. Hosts will
   communicate with these backends to retrieve secrets on behalf of
   applications before they are instantiated for the first time, similar to
   what we do with config.
   
   Common types and errors are stored in a separate crate so that other
   Rust implementations can reference them. As a follow up we should add
   OpenAPI specifications for these types to make it easier to develop
   backends written in other languages.
   
   The NATS KV backend implements the secrets API in addition to several
   unique endpoints for managing secrets and mappings between
   components/providers and keys. These endpoints are _not_ expected to be
   duplicated in any other implementation, but are only available to define
   an interface for managing secrets in NATS KV. Other backends will likely
   have their own process for managing secrets out of band and only be
   concerned with retrieving them.
   
   Secret payloads are encrypted using a key provided by the host on each
   request and a dedicated encryption key generated by the backend. For
   more information on why there are two keys, [see this
   link](https://cr.yp.to/ecdh.html) that decribes how Curve25519 works.
   The host is expected to provide two forms of _context_: the _runtime_
   context, which is information about the host itself including its
   labels, and the _build_ context of the component or provider, which is
   the signed JWT that it was built with. For now, both are expected to be
   present so that a secrets backend can pass that information to upstream
   APIs in order to make a policy decision on whether or not the component
   or provider is allowed to access that secret. For now, the host JWT will
   need to be self signed. This will change in future releases of wasmCloud
   where we will have better ways of providing signing keys to new hosts.
   
   In this particular implementation, secrets are stored encrypted in the
   KV bucket with a xkey, similar to how other secrets managers store
   secrets at rest.

### Bug Fixes

 - <csr-id-0346adee762f519e6cf377b84b4fdf0dce83c12d/> correct secret reference format

### Refactor

 - <csr-id-c666ef50fecc1ee248bf78d486a915ee077e3b4a/> include name with secret config
 - <csr-id-2ea22a28ca9fd1838fc03451f33d75690fc28f2a/> move SecretConfig into crate
 - <csr-id-b56982f437209ecaff4fa6946f8fe4c3068a62cd/> address feedback, application name optional

### New Features (BREAKING)

 - <csr-id-61b7cf6cdc878d0904f0d07a920c0816d4e5b100/> add field to request and config

### Bug Fixes (BREAKING)

 - <csr-id-37601b495343768a430447a4358b235a60a4300b/> remove unneeded name field

